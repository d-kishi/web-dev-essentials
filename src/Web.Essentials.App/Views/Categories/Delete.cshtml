@model Web.Essentials.App.ViewModels.CategoryDetailsViewModel
@{
    ViewData["Title"] = $"ã‚«ãƒ†ã‚´ãƒªå‰Šé™¤ç¢ºèª - {Model.Name}";
}

<!-- ã‚«ãƒ†ã‚´ãƒªå‰Šé™¤ç¢ºèªç”»é¢ -->
<div class="page-header">
    <div class="page-title-section">
        <h1 class="page-title">ã‚«ãƒ†ã‚´ãƒªå‰Šé™¤ç¢ºèª</h1>
        <p class="page-description">ã‚«ãƒ†ã‚´ãƒªã€Œ@Model.Nameã€ã®å‰Šé™¤ç¢ºèªã§ã™ã€‚å‰Šé™¤ã™ã‚‹ã¨å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚</p>
    </div>
</div>

<!-- ãƒ‘ãƒ³ããšãƒŠãƒ“ -->
<nav class="breadcrumb-nav" aria-label="ãƒ‘ãƒ³ããšãƒŠãƒ“">
    <ol class="breadcrumb">
        <li class="breadcrumb-item">
            <a href="@Url.Action("Index", "Home")">ãƒ›ãƒ¼ãƒ </a>
        </li>
        <li class="breadcrumb-item">
            <a href="@Url.Action("Index", "Categories")">ã‚«ãƒ†ã‚´ãƒªä¸€è¦§</a>
        </li>
        <li class="breadcrumb-item">
            <a href="@Url.Action("Details", "Categories", new { id = Model.Id })">@Model.Name</a>
        </li>
        <li class="breadcrumb-item active" aria-current="page">
            å‰Šé™¤ç¢ºèª
        </li>
    </ol>
</nav>

<!-- å‰Šé™¤å¯å¦åˆ¤å®š -->
@{
    var canDelete = Model.ProductCount == 0 && (Model.ChildCategories?.Any() != true);
    var blockingReasons = new List<string>();
    
    if (Model.ProductCount > 0)
    {
        blockingReasons.Add($"{Model.ProductCount}å€‹ã®å•†å“ãŒé–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹");
    }
    
    if (Model.ChildCategories?.Any() == true)
    {
        blockingReasons.Add($"{Model.ChildCategories.Count()}å€‹ã®å­ã‚«ãƒ†ã‚´ãƒªãŒå­˜åœ¨ã™ã‚‹");
    }
}

<!-- å‰Šé™¤è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
@if (!canDelete)
{
    <div class="alert alert-error delete-blocked">
        <div class="alert-icon">ğŸš«</div>
        <div class="alert-content">
            <h3 class="alert-title">å‰Šé™¤ã§ãã¾ã›ã‚“</h3>
            <p class="alert-message">
                ã“ã®ã‚«ãƒ†ã‚´ãƒªã¯ä»¥ä¸‹ã®ç†ç”±ã«ã‚ˆã‚Šå‰Šé™¤ã§ãã¾ã›ã‚“ï¼š
            </p>
            <ul class="blocking-reasons">
                @foreach (var reason in blockingReasons)
                {
                    <li>@reason</li>
                }
            </ul>
            <p class="resolution-message">
                ã‚«ãƒ†ã‚´ãƒªã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€é–¢é€£ã™ã‚‹å•†å“ã‚„å­ã‚«ãƒ†ã‚´ãƒªã‚’å…ˆã«å‰Šé™¤ã¾ãŸã¯ç§»å‹•ã—ã¦ãã ã•ã„ã€‚
            </p>
        </div>
    </div>
}
else
{
    <div class="alert alert-danger delete-warning">
        <div class="alert-icon">âš ï¸</div>
        <div class="alert-content">
            <h3 class="alert-title">å‰Šé™¤ã®ç¢ºèª</h3>
            <p class="alert-message">
                ã“ã®æ“ä½œã¯å…ƒã«æˆ»ã™ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚ã‚«ãƒ†ã‚´ãƒªã«é–¢é€£ã™ã‚‹ã™ã¹ã¦ã®æƒ…å ±ã‚‚åŒæ™‚ã«å‰Šé™¤ã•ã‚Œã¾ã™ã€‚
            </p>
        </div>
    </div>
}

<!-- ã‚«ãƒ†ã‚´ãƒªè©³ç´°è¡¨ç¤ºï¼ˆå‰Šé™¤ç¢ºèªç”¨ï¼‰ -->
<div class="delete-confirmation-container">
    <div class="category-summary">
        <div class="summary-header">
            <h2 class="summary-title">å‰Šé™¤å¯¾è±¡ã®ã‚«ãƒ†ã‚´ãƒª</h2>
        </div>
        
        <div class="summary-content">
            <!-- ã‚«ãƒ†ã‚´ãƒªåŸºæœ¬æƒ…å ± -->
            <div class="category-info-card">
                <div class="category-overview">
                    <div class="category-header">
                        <h3 class="category-name">@Model.Name</h3>
                        <span class="level-badge level-@Model.Level">ãƒ¬ãƒ™ãƒ« @Model.Level</span>
                    </div>
                    
                    @if (!string.IsNullOrEmpty(Model.Description))
                    {
                        <div class="category-description">
                            @(Model.Description.Length > 150 ? Model.Description.Substring(0, 150) + "..." : Model.Description)
                        </div>
                    }
                    
                    @if (!string.IsNullOrEmpty(Model.FullPath))
                    {
                        <div class="category-path">
                            <label class="path-label">éšå±¤ãƒ‘ã‚¹:</label>
                            <span class="path-value">@Model.FullPath</span>
                        </div>
                    }
                </div>
                
                <!-- è©³ç´°æƒ…å ± -->
                <div class="category-metadata">
                    <div class="metadata-grid">
                        <div class="metadata-item">
                            <label class="metadata-label">ã‚«ãƒ†ã‚´ãƒªID</label>
                            <span class="metadata-value">@Model.Id</span>
                        </div>
                        
                        <div class="metadata-item">
                            <label class="metadata-label">éšå±¤ãƒ¬ãƒ™ãƒ«</label>
                            <span class="metadata-value">@Model.Level</span>
                        </div>
                        
                        <div class="metadata-item">
                            <label class="metadata-label">ä½œæˆæ—¥æ™‚</label>
                            <span class="metadata-value">
                                @Model.CreatedAt.ToString("yyyy/MM/dd HH:mm:ss")
                            </span>
                        </div>
                        
                        <div class="metadata-item">
                            <label class="metadata-label">æœ€çµ‚æ›´æ–°æ—¥æ™‚</label>
                            <span class="metadata-value">
                                @Model.UpdatedAt.ToString("yyyy/MM/dd HH:mm:ss")
                            </span>
                        </div>
                        
                        <div class="metadata-item">
                            <label class="metadata-label">é–¢é€£å•†å“æ•°</label>
                            <span class="metadata-value @(Model.ProductCount > 0 ? "text-warning" : "")">
                                @Model.ProductCount å€‹
                            </span>
                        </div>
                        
                        <div class="metadata-item">
                            <label class="metadata-label">å­ã‚«ãƒ†ã‚´ãƒªæ•°</label>
                            <span class="metadata-value @(Model.ChildCategories?.Any() == true ? "text-warning" : "")">
                                @(Model.ChildCategories?.Count() ?? 0) å€‹
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- å‰Šé™¤å½±éŸ¿ç¯„å›² -->
    <div class="deletion-impact">
        <h3 class="impact-title">å‰Šé™¤ã•ã‚Œã‚‹å†…å®¹</h3>
        <div class="impact-list">
            <div class="impact-item">
                <span class="impact-icon">ğŸ·ï¸</span>
                <div class="impact-content">
                    <strong>ã‚«ãƒ†ã‚´ãƒªåŸºæœ¬æƒ…å ±</strong>
                    <p>ã‚«ãƒ†ã‚´ãƒªåã€èª¬æ˜ã€éšå±¤æƒ…å ±ãªã©ã®åŸºæœ¬æƒ…å ±</p>
                </div>
            </div>
            
            @if (Model.ProductCount > 0)
            {
                <div class="impact-item impact-blocking">
                    <span class="impact-icon">ğŸ“¦</span>
                    <div class="impact-content">
                        <strong>é–¢é€£å•†å“ã®é–¢é€£ä»˜ã‘</strong>
                        <p>@Model.ProductCount å€‹ã®å•†å“ã¨ã®ã‚«ãƒ†ã‚´ãƒªé–¢é€£ä»˜ã‘ï¼ˆå•†å“è‡ªä½“ã¯å‰Šé™¤ã•ã‚Œã¾ã›ã‚“ï¼‰</p>
                        <div class="blocking-note">â€» å•†å“ãŒé–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ãŸã‚å‰Šé™¤ã§ãã¾ã›ã‚“</div>
                    </div>
                </div>
            }
            
            @if (Model.ChildCategories?.Any() == true)
            {
                <div class="impact-item impact-blocking">
                    <span class="impact-icon">ğŸŒ³</span>
                    <div class="impact-content">
                        <strong>å­ã‚«ãƒ†ã‚´ãƒªã®éšå±¤æ§‹é€ </strong>
                        <p>@Model.ChildCategories.Count() å€‹ã®å­ã‚«ãƒ†ã‚´ãƒªã®è¦ªå­é–¢ä¿‚</p>
                        <div class="blocking-note">â€» å­ã‚«ãƒ†ã‚´ãƒªãŒå­˜åœ¨ã™ã‚‹ãŸã‚å‰Šé™¤ã§ãã¾ã›ã‚“</div>
                    </div>
                </div>
            }
            
            <div class="impact-item">
                <span class="impact-icon">ğŸ“Š</span>
                <div class="impact-content">
                    <strong>å±¥æ­´ãƒ»ãƒ­ã‚°æƒ…å ±</strong>
                    <p>ã‚«ãƒ†ã‚´ãƒªã«é–¢é€£ã™ã‚‹ã™ã¹ã¦ã®å¤‰æ›´å±¥æ­´ã¨ãƒ­ã‚°æƒ…å ±</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- é–¢é€£å•†å“ãƒ»å­ã‚«ãƒ†ã‚´ãƒªã®è©³ç´° -->
    @if (!canDelete)
    {
        <div class="blocking-details">
            <h3 class="blocking-title">å‰Šé™¤ã‚’é˜»å®³ã—ã¦ã„ã‚‹è¦ç´ </h3>
            
            @if (Model.ProductCount > 0 && Model.RelatedProducts?.Any() == true)
            {
                <div class="blocking-section">
                    <h4 class="blocking-subtitle">é–¢é€£å•†å“ (@Model.ProductCount å€‹)</h4>
                    <div class="blocking-items">
                        @foreach (var product in Model.RelatedProducts.Take(5))
                        {
                            <div class="blocking-item">
                                <span class="item-name">@product.Name</span>
                                <span class="item-price">Â¥@product.Price.ToString("N0")</span>
                                <a href="@Url.Action("Details", "Products", new { id = product.Id })" 
                                   class="btn btn-sm btn-info">è©³ç´°</a>
                                <a href="@Url.Action("Edit", "Products", new { id = product.Id })" 
                                   class="btn btn-sm btn-warning">ç·¨é›†</a>
                            </div>
                        }
                        @if (Model.RelatedProducts.Count() > 5)
                        {
                            <div class="more-items">
                                ä»– @(Model.RelatedProducts.Count() - 5) å€‹ã®å•†å“...
                                <a href="@Url.Action("Index", "Products", new { categoryId = Model.Id })" 
                                   class="view-all-link">ã™ã¹ã¦è¡¨ç¤º</a>
                            </div>
                        }
                    </div>
                    <div class="resolution-action">
                        <p class="resolution-text">ã“ã‚Œã‚‰ã®å•†å“ã®ã‚«ãƒ†ã‚´ãƒªé–¢é€£ä»˜ã‘ã‚’å‰Šé™¤ã¾ãŸã¯å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚</p>
                        <a href="@Url.Action("Index", "Products", new { categoryId = Model.Id })" 
                           class="btn btn-warning">é–¢é€£å•†å“ã‚’ç®¡ç†</a>
                    </div>
                </div>
            }
            
            @if (Model.ChildCategories?.Any() == true)
            {
                <div class="blocking-section">
                    <h4 class="blocking-subtitle">å­ã‚«ãƒ†ã‚´ãƒª (@Model.ChildCategories.Count() å€‹)</h4>
                    <div class="blocking-items">
                        @foreach (var child in Model.ChildCategories)
                        {
                            <div class="blocking-item">
                                <span class="item-name">@child.Name</span>
                                <span class="item-path">(@child.FullPath)</span>
                                <span class="item-products">@child.ProductCount å•†å“</span>
                                <a href="@Url.Action("Details", "Categories", new { id = child.Id })" 
                                   class="btn btn-sm btn-info">è©³ç´°</a>
                                <a href="@Url.Action("Edit", "Categories", new { id = child.Id })" 
                                   class="btn btn-sm btn-warning">ç·¨é›†</a>
                            </div>
                        }
                    </div>
                    <div class="resolution-action">
                        <p class="resolution-text">ã“ã‚Œã‚‰ã®å­ã‚«ãƒ†ã‚´ãƒªã‚’å‰Šé™¤ã™ã‚‹ã‹ã€ä»–ã®è¦ªã‚«ãƒ†ã‚´ãƒªã«ç§»å‹•ã—ã¦ãã ã•ã„ã€‚</p>
                        <a href="@Url.Action("Index", "Categories")" 
                           class="btn btn-warning">å­ã‚«ãƒ†ã‚´ãƒªã‚’ç®¡ç†</a>
                    </div>
                </div>
            }
        </div>
    }
    
    <!-- å‰Šé™¤å®Ÿè¡Œãƒ•ã‚©ãƒ¼ãƒ  -->
    @if (canDelete)
    {
        <div class="deletion-form">
            <form asp-action="Delete" method="post" id="deleteForm" class="delete-confirmation-form">
                @Html.AntiForgeryToken()
                @Html.HiddenFor(model => model.Id)
                
                <!-- å‰Šé™¤ç¢ºèªãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ -->
                <div class="confirmation-checks">
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="confirmUnderstand" class="checkbox-input" required>
                            <span class="checkbox-custom"></span>
                            å‰Šé™¤ã®å½±éŸ¿ã‚’ç†è§£ã—ã€ã“ã®æ“ä½œãŒå…ƒã«æˆ»ã›ãªã„ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ãŸ
                        </label>
                    </div>
                    
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="confirmCategoryName" class="checkbox-input" required>
                            <span class="checkbox-custom"></span>
                            å‰Šé™¤å¯¾è±¡ã®ã‚«ãƒ†ã‚´ãƒªãŒã€Œ@Model.Nameã€ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ãŸ
                        </label>
                    </div>
                </div>
                
                <!-- å‰Šé™¤ç†ç”±ï¼ˆä»»æ„ï¼‰ -->
                <div class="deletion-reason">
                    <label for="deletionReason" class="form-label">å‰Šé™¤ç†ç”±ï¼ˆä»»æ„ï¼‰</label>
                    <textarea id="deletionReason" 
                              name="DeletionReason" 
                              class="form-textarea"
                              placeholder="å‰Šé™¤ç†ç”±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆãƒ­ã‚°ã«è¨˜éŒ²ã•ã‚Œã¾ã™ï¼‰"
                              rows="3"
                              maxlength="500"></textarea>
                    <div class="field-hint">æœ€å¤§500æ–‡å­—ã¾ã§å…¥åŠ›ã§ãã¾ã™</div>
                </div>
                
                <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                <div class="form-actions">
                    <div class="action-buttons">
                        <button type="submit" 
                                class="btn btn-danger btn-large" 
                                id="deleteButton"
                                disabled>
                            <span class="btn-icon">ğŸ—‘ï¸</span>
                            ã‚«ãƒ†ã‚´ãƒªã‚’å‰Šé™¤ã™ã‚‹
                        </button>
                        <a href="@Url.Action("Details", "Categories", new { id = Model.Id })" 
                           class="btn btn-secondary btn-large">
                            <span class="btn-icon">â†©ï¸</span>
                            ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼ˆè©³ç´°ã«æˆ»ã‚‹ï¼‰
                        </a>
                        <a href="@Url.Action("Index", "Categories")" 
                           class="btn btn-light btn-large">
                            <span class="btn-icon">ğŸ“‹</span>
                            ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ã«æˆ»ã‚‹
                        </a>
                    </div>
                </div>
            </form>
        </div>
    }
    else
    {
        <!-- å‰Šé™¤ä¸å¯ã®å ´åˆã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="cannot-delete-actions">
            <div class="action-buttons">
                <a href="@Url.Action("Details", "Categories", new { id = Model.Id })" 
                   class="btn btn-secondary btn-large">
                    <span class="btn-icon">â†©ï¸</span>
                    è©³ç´°ã«æˆ»ã‚‹
                </a>
                <a href="@Url.Action("Index", "Categories")" 
                   class="btn btn-light btn-large">
                    <span class="btn-icon">ğŸ“‹</span>
                    ã‚«ãƒ†ã‚´ãƒªä¸€è¦§ã«æˆ»ã‚‹
                </a>
                <a href="@Url.Action("Edit", "Categories", new { id = Model.Id })" 
                   class="btn btn-warning btn-large">
                    <span class="btn-icon">âœ</span>
                    ã‚«ãƒ†ã‚´ãƒªã‚’ç·¨é›†
                </a>
            </div>
        </div>
    }
</div>

@if (canDelete)
{
    @section Scripts {
        <script>
            // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
            document.addEventListener('DOMContentLoaded', function() {
                initializeDeleteConfirmation();
            });
            
            // å‰Šé™¤ç¢ºèªã®åˆæœŸåŒ–
            function initializeDeleteConfirmation() {
                // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹ç›£è¦–
                setupConfirmationValidation();
                
                // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã®å‡¦ç†
                setupFormSubmission();
                
                // ãƒšãƒ¼ã‚¸é›¢è„±è­¦å‘Š
                setupUnloadWarning();
            }
            
            // ç¢ºèªãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®æ¤œè¨¼è¨­å®š
            function setupConfirmationValidation() {
                const confirmUnderstand = document.getElementById('confirmUnderstand');
                const confirmCategoryName = document.getElementById('confirmCategoryName');
                const deleteButton = document.getElementById('deleteButton');
                
                function validateConfirmations() {
                    const allChecked = confirmUnderstand.checked && confirmCategoryName.checked;
                    deleteButton.disabled = !allChecked;
                    
                    if (allChecked) {
                        deleteButton.classList.remove('btn-disabled');
                    } else {
                        deleteButton.classList.add('btn-disabled');
                    }
                }
                
                confirmUnderstand.addEventListener('change', validateConfirmations);
                confirmCategoryName.addEventListener('change', validateConfirmations);
            }
            
            // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã®è¨­å®š
            function setupFormSubmission() {
                const deleteForm = document.getElementById('deleteForm');
                
                deleteForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    // æœ€çµ‚ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
                    showFinalConfirmation();
                });
            }
            
            // æœ€çµ‚ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
            function showFinalConfirmation() {
                const categoryName = '@Model.Name';
                const confirmMessage = `æœ¬å½“ã«ã‚«ãƒ†ã‚´ãƒªã€Œ${categoryName}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n\nã“ã®æ“ä½œã¯å…ƒã«æˆ»ã™ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚`;
                
                showConfirmationModal(
                    'æœ€çµ‚ç¢ºèª',
                    confirmMessage,
                    'å‰Šé™¤å¾Œã¯ã‚«ãƒ†ã‚´ãƒªã«é–¢é€£ã™ã‚‹ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒå¤±ã‚ã‚Œã¾ã™ã€‚',
                    'å‰Šé™¤ã™ã‚‹',
                    () => executeDelete()
                );
            }
            
            // å‰Šé™¤å®Ÿè¡Œ
            async function executeDelete() {
                try {
                    showLoadingModal('ã‚«ãƒ†ã‚´ãƒªã‚’å‰Šé™¤ã—ã¦ã„ã¾ã™...\nã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚');
                    
                    const formData = new FormData(document.getElementById('deleteForm'));
                    
                    const response = await fetch('/Categories/Delete/@Model.Id', {
                        method: 'POST',
                        body: formData
                    });
                    
                    hideLoadingModal();
                    
                    if (response.ok) {
                        // å‰Šé™¤æˆåŠŸ
                        showSuccessModal(
                            'å‰Šé™¤å®Œäº†',
                            'ã‚«ãƒ†ã‚´ãƒªã€Œ@Model.Nameã€ãŒæ­£å¸¸ã«å‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚',
                            () => {
                                window.location.href = '/Categories';
                            }
                        );
                    } else {
                        // å‰Šé™¤å¤±æ•—
                        const errorText = await response.text();
                        showError('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + errorText);
                    }
                } catch (error) {
                    hideLoadingModal();
                    console.error('ã‚«ãƒ†ã‚´ãƒªå‰Šé™¤ã‚¨ãƒ©ãƒ¼:', error);
                    showError('å‰Šé™¤å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
                }
            }
            
            // ãƒšãƒ¼ã‚¸é›¢è„±è­¦å‘Šã®è¨­å®š
            function setupUnloadWarning() {
                let formInteracted = false;
                
                // ãƒ•ã‚©ãƒ¼ãƒ æ“ä½œã®æ¤œçŸ¥
                document.querySelectorAll('input, textarea').forEach(element => {
                    element.addEventListener('input', () => {
                        formInteracted = true;
                    });
                    element.addEventListener('change', () => {
                        formInteracted = true;
                    });
                });
                
                // ãƒšãƒ¼ã‚¸é›¢è„±æ™‚ã®è­¦å‘Š
                window.addEventListener('beforeunload', function(event) {
                    if (formInteracted) {
                        event.preventDefault();
                        event.returnValue = 'å‰Šé™¤ç¢ºèªç”»é¢ã‹ã‚‰é›¢ã‚Œã¾ã™ã‹ï¼Ÿ';
                    }
                });
            }
            
            // æˆåŠŸãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º
            function showSuccessModal(title, message, callback) {
                const modal = document.createElement('div');
                modal.className = 'modal-overlay success-modal';
                modal.innerHTML = `
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h3 class="modal-title">${title}</h3>
                            </div>
                            <div class="modal-body">
                                <div class="success-icon">âœ…</div>
                                <p class="success-message">${message}</p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-primary" onclick="this.closest('.modal-overlay').remove(); ${callback ? callback.toString() + '()' : ''}">
                                    ç¢ºèª
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                modal.style.display = 'block';
            }
            
            // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
            function showError(message) {
                const errorContainer = document.createElement('div');
                errorContainer.className = 'alert alert-danger error-message';
                errorContainer.innerHTML = `
                    <div class="alert-icon">âŒ</div>
                    <div class="alert-content">
                        <strong>ã‚¨ãƒ©ãƒ¼</strong>
                        <p>${message}</p>
                    </div>
                    <button type="button" class="alert-close" onclick="this.parentElement.remove()">Ã—</button>
                `;
                
                // ãƒšãƒ¼ã‚¸ä¸Šéƒ¨ã«æŒ¿å…¥
                const pageHeader = document.querySelector('.page-header');
                pageHeader.insertAdjacentElement('afterend', errorContainer);
                
                // è‡ªå‹•å‰Šé™¤ï¼ˆ10ç§’å¾Œï¼‰
                setTimeout(() => {
                    if (errorContainer.parentElement) {
                        errorContainer.remove();
                    }
                }, 10000);
            }
            
            // ESCã‚­ãƒ¼ã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    if (confirm('å‰Šé™¤ç¢ºèªã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¦è©³ç´°ç”»é¢ã«æˆ»ã‚Šã¾ã™ã‹ï¼Ÿ')) {
                        window.location.href = '/Categories/Details/@Model.Id';
                    }
                }
            });
        </script>
    }
}