@model dynamic
<!-- å•†å“ç”»åƒç®¡ç†éƒ¨åˆ†ãƒ“ãƒ¥ãƒ¼ -->
<!-- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€å‰Šé™¤æ©Ÿèƒ½ -->
<!-- Create/Editç”»é¢ã§å…±é€šåˆ©ç”¨ -->

<div class="product-image-upload-container">
    <!-- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="form-section">
        <h3 class="section-title">å•†å“ç”»åƒ</h3>
        <div class="image-upload-area">
            <!-- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢ -->
            <div class="upload-zone" id="imageUploadZone">
                <div class="upload-content">
                    <div class="upload-icon">ğŸ“·</div>
                    <h4 class="upload-title">ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h4>
                    <p class="upload-description">
                        ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ã‹ã€ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠã—ã¦ãã ã•ã„
                    </p>
                    <button type="button" class="btn btn-outline" onclick="triggerFileInput()">
                        ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
                    </button>
                    <input type="file" 
                           id="imageFileInput" 
                           name="ImageFiles" 
                           accept="image/jpeg,image/png,image/gif" 
                           multiple 
                           style="display: none;"
                           onchange="handleFileSelect(this.files)" />
                </div>
                <div class="upload-constraints">
                    <small>
                        â€¢ å¯¾å¿œå½¢å¼: JPEG, PNG, GIF<br>
                        â€¢ æœ€å¤§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: 5MB<br>
                        â€¢ æœ€å¤§5æšã¾ã§ç™»éŒ²å¯èƒ½
                    </small>
                </div>
            </div>
            
            <!-- ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
            <div id="imagePreviewArea" class="image-preview-area" style="display: none;">
                <h4 class="preview-title">ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h4>
                <div id="imagePreviewContainer" class="image-preview-container">
                    <!-- ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
                </div>
                <div class="preview-actions">
                    <button type="button" class="btn btn-outline btn-sm" onclick="clearAllImages()">
                        ã™ã¹ã¦ã‚¯ãƒªã‚¢
                    </button>
                    <button type="button" class="btn btn-light btn-sm" onclick="reorderImages()">
                        ä¸¦ã³é †å¤‰æ›´
                    </button>
                </div>
            </div>
            
            <!-- æ—¢å­˜ç”»åƒè¡¨ç¤ºã‚¨ãƒªã‚¢ï¼ˆEditç”»é¢ç”¨ï¼‰ -->
            <div id="existingImagesArea" class="existing-images-area" style="display: none;">
                <h4 class="existing-title">ç¾åœ¨ã®ç”»åƒ</h4>
                <div id="existingImageContainer" class="existing-image-container">
                    <!-- æ—¢å­˜ç”»åƒãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ç”»åƒç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="imageEditModal" class="modal-overlay image-edit-modal" style="display: none;">
    <div class="modal-dialog modal-large">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">ç”»åƒç·¨é›†</h3>
                <button type="button" class="modal-close" onclick="closeImageEditModal()">
                    <span>Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="image-edit-container">
                    <div class="image-edit-preview">
                        <img id="editPreviewImage" src="" alt="ç·¨é›†å¯¾è±¡ç”»åƒ" class="edit-preview-img" />
                    </div>
                    <div class="image-edit-form">
                        <div class="form-group">
                            <label for="imageAltText" class="form-label">ä»£æ›¿ãƒ†ã‚­ã‚¹ãƒˆ</label>
                            <input type="text" 
                                   id="imageAltText" 
                                   class="form-input" 
                                   placeholder="ç”»åƒã®èª¬æ˜ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
                                   maxlength="200" />
                            <div class="field-help">
                                <small>ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å‘ä¸Šã®ãŸã‚ã€ç”»åƒã®å†…å®¹ã‚’èª¬æ˜ã—ã¦ãã ã•ã„</small>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="imageDisplayOrder" class="form-label">è¡¨ç¤ºé †åº</label>
                            <select id="imageDisplayOrder" class="form-select">
                                <option value="1">1ç•ªç›®ï¼ˆãƒ¡ã‚¤ãƒ³ç”»åƒï¼‰</option>
                                <option value="2">2ç•ªç›®</option>
                                <option value="3">3ç•ªç›®</option>
                                <option value="4">4ç•ªç›®</option>
                                <option value="5">5ç•ªç›®</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="imageIsMain" class="checkbox-input">
                                    <span class="checkbox-custom"></span>
                                    ãƒ¡ã‚¤ãƒ³ç”»åƒã¨ã—ã¦è¨­å®š
                                </label>
                            </div>
                            <div class="field-help">
                                <small>å•†å“ä¸€è¦§ã‚„è©³ç´°ç”»é¢ã§æœ€åˆã«è¡¨ç¤ºã•ã‚Œã‚‹ç”»åƒã§ã™</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeImageEditModal()">
                    ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                </button>
                <button type="button" class="btn btn-primary" onclick="saveImageSettings()">
                    è¨­å®šã‚’ä¿å­˜
                </button>
            </div>
        </div>
    </div>
</div>

<!-- ç”»åƒæ‹¡å¤§è¡¨ç¤ºãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="imageViewModal" class="modal-overlay image-view-modal" style="display: none;" onclick="closeImageViewModal()">
    <div class="modal-dialog modal-large">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="imageViewTitle">ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h3>
                <button type="button" class="modal-close" onclick="closeImageViewModal()">
                    <span>Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="image-view-container">
                    <img id="viewImage" src="" alt="" class="view-image" />
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // ç”»åƒç®¡ç†å¤‰æ•°
    let uploadedImages = [];
    let existingImages = [];
    let currentEditingIndex = -1;
    let maxImages = 5;
    let maxFileSize = 5 * 1024 * 1024; // 5MB
    
    // ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰åˆæœŸåŒ–
    function initializeImageUpload() {
        setupDropZone();
        setupFileValidation();
        loadExistingImages();
    }
    
    // ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³ã®è¨­å®š
    function setupDropZone() {
        const uploadZone = document.getElementById('imageUploadZone');
        
        // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã‚¤ãƒ™ãƒ³ãƒˆ
        uploadZone.addEventListener('dragover', function(e) {
            e.preventDefault();
            uploadZone.classList.add('drag-over');
        });
        
        uploadZone.addEventListener('dragleave', function(e) {
            e.preventDefault();
            uploadZone.classList.remove('drag-over');
        });
        
        uploadZone.addEventListener('drop', function(e) {
            e.preventDefault();
            uploadZone.classList.remove('drag-over');
            handleFileSelect(e.dataTransfer.files);
        });
        
        // ã‚¯ãƒªãƒƒã‚¯ã§ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
        uploadZone.addEventListener('click', function() {
            triggerFileInput();
        });
    }
    
    // ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ãƒˆãƒªã‚¬ãƒ¼
    function triggerFileInput() {
        document.getElementById('imageFileInput').click();
    }
    
    // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠå‡¦ç†
    function handleFileSelect(files) {
        const fileArray = Array.from(files);
        
        // æœ€å¤§æšæ•°ãƒã‚§ãƒƒã‚¯
        if (uploadedImages.length + fileArray.length > maxImages) {
            showError(`ç”»åƒã¯æœ€å¤§${maxImages}æšã¾ã§ç™»éŒ²å¯èƒ½ã§ã™`);
            return;
        }
        
        fileArray.forEach(file => {
            if (validateFile(file)) {
                processImageFile(file);
            }
        });
    }
    
    // ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    function validateFile(file) {
        // ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ãƒã‚§ãƒƒã‚¯
        const allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];
        if (!allowedTypes.includes(file.type)) {
            showError(`å¯¾å¿œã—ã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã™: ${file.name}`);
            return false;
        }
        
        // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯
        if (file.size > maxFileSize) {
            showError(`ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã™ãã¾ã™: ${file.name} (æœ€å¤§5MB)`);
            return false;
        }
        
        return true;
    }
    
    // ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†
    function processImageFile(file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            const imageData = {
                file: file,
                dataUrl: e.target.result,
                name: file.name,
                size: file.size,
                altText: '',
                displayOrder: uploadedImages.length + 1,
                isMain: uploadedImages.length === 0 // æœ€åˆã®ç”»åƒã‚’ãƒ¡ã‚¤ãƒ³ã«è¨­å®š
            };
            
            uploadedImages.push(imageData);
            updateImagePreview();
        };
        
        reader.readAsDataURL(file);
    }
    
    // ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
    function updateImagePreview() {
        const previewArea = document.getElementById('imagePreviewArea');
        const previewContainer = document.getElementById('imagePreviewContainer');
        
        if (uploadedImages.length === 0) {
            previewArea.style.display = 'none';
            return;
        }
        
        previewArea.style.display = 'block';
        
        const previewHtml = uploadedImages.map((image, index) => `
            <div class="image-preview-item ${image.isMain ? 'main-image' : ''}" data-index="${index}">
                <div class="preview-image-container">
                    <img src="${image.dataUrl}" alt="${image.altText || image.name}" class="preview-image" />
                    <div class="preview-overlay">
                        <button type="button" class="overlay-btn edit-btn" onclick="openImageEditModal(${index})" title="ç·¨é›†">
                            âœï¸
                        </button>
                        <button type="button" class="overlay-btn view-btn" onclick="openImageViewModal('${image.dataUrl}', '${image.name}')" title="æ‹¡å¤§è¡¨ç¤º">
                            ğŸ”
                        </button>
                        <button type="button" class="overlay-btn delete-btn" onclick="removeImage(${index})" title="å‰Šé™¤">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                    ${image.isMain ? '<div class="main-badge">ãƒ¡ã‚¤ãƒ³</div>' : ''}
                </div>
                <div class="preview-info">
                    <div class="preview-name">${image.name}</div>
                    <div class="preview-details">
                        <span class="preview-size">${formatFileSize(image.size)}</span>
                        <span class="preview-order">é †åº: ${image.displayOrder}</span>
                    </div>
                </div>
            </div>
        `).join('');
        
        previewContainer.innerHTML = previewHtml;
        
        // ã‚½ãƒ¼ãƒˆå¯èƒ½ã«ã™ã‚‹
        setupImageSorting();
    }
    
    // ç”»åƒå‰Šé™¤
    function removeImage(index) {
        if (confirm('ã“ã®ç”»åƒã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
            uploadedImages.splice(index, 1);
            
            // è¡¨ç¤ºé †åºã‚’å†èª¿æ•´
            uploadedImages.forEach((image, idx) => {
                image.displayOrder = idx + 1;
            });
            
            // ãƒ¡ã‚¤ãƒ³ç”»åƒãŒå‰Šé™¤ã•ã‚ŒãŸå ´åˆã€æœ€åˆã®ç”»åƒã‚’ãƒ¡ã‚¤ãƒ³ã«è¨­å®š
            if (uploadedImages.length > 0 && !uploadedImages.some(img => img.isMain)) {
                uploadedImages[0].isMain = true;
            }
            
            updateImagePreview();
        }
    }
    
    // ã™ã¹ã¦ã®ç”»åƒã‚’ã‚¯ãƒªã‚¢
    function clearAllImages() {
        if (uploadedImages.length === 0) return;
        
        if (confirm('ã™ã¹ã¦ã®ç”»åƒã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
            uploadedImages = [];
            updateImagePreview();
        }
    }
    
    // ç”»åƒç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    function openImageEditModal(index) {
        if (index < 0 || index >= uploadedImages.length) return;
        
        currentEditingIndex = index;
        const image = uploadedImages[index];
        
        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã«ç¾åœ¨ã®è¨­å®šã‚’è¡¨ç¤º
        document.getElementById('editPreviewImage').src = image.dataUrl;
        document.getElementById('imageAltText').value = image.altText || '';
        document.getElementById('imageDisplayOrder').value = image.displayOrder;
        document.getElementById('imageIsMain').checked = image.isMain;
        
        document.getElementById('imageEditModal').style.display = 'block';
        document.body.style.overflow = 'hidden';
    }
    
    // ç”»åƒç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    function closeImageEditModal() {
        document.getElementById('imageEditModal').style.display = 'none';
        document.body.style.overflow = 'auto';
        currentEditingIndex = -1;
    }
    
    // ç”»åƒè¨­å®šä¿å­˜
    function saveImageSettings() {
        if (currentEditingIndex < 0) return;
        
        const image = uploadedImages[currentEditingIndex];
        const altText = document.getElementById('imageAltText').value;
        const displayOrder = parseInt(document.getElementById('imageDisplayOrder').value);
        const isMain = document.getElementById('imageIsMain').checked;
        
        // è¨­å®šã‚’æ›´æ–°
        image.altText = altText;
        image.displayOrder = displayOrder;
        
        // ãƒ¡ã‚¤ãƒ³ç”»åƒè¨­å®š
        if (isMain) {
            // ä»–ã®ç”»åƒã®ãƒ¡ã‚¤ãƒ³è¨­å®šã‚’è§£é™¤
            uploadedImages.forEach(img => img.isMain = false);
            image.isMain = true;
        }
        
        // è¡¨ç¤ºé †åºã§ã‚½ãƒ¼ãƒˆ
        uploadedImages.sort((a, b) => a.displayOrder - b.displayOrder);
        
        updateImagePreview();
        closeImageEditModal();
        
        showSuccess('ç”»åƒè¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
    }
    
    // ç”»åƒæ‹¡å¤§è¡¨ç¤ºãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
    function openImageViewModal(imageSrc, imageName) {
        document.getElementById('viewImage').src = imageSrc;
        document.getElementById('imageViewTitle').textContent = imageName;
        document.getElementById('imageViewModal').style.display = 'block';
        document.body.style.overflow = 'hidden';
    }
    
    // ç”»åƒæ‹¡å¤§è¡¨ç¤ºãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
    function closeImageViewModal() {
        document.getElementById('imageViewModal').style.display = 'none';
        document.body.style.overflow = 'auto';
    }
    
    // ç”»åƒä¸¦ã³æ›¿ãˆæ©Ÿèƒ½
    function setupImageSorting() {
        // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ã®ä¸¦ã³æ›¿ãˆå®Ÿè£…
        const previewContainer = document.getElementById('imagePreviewContainer');
        let draggedElement = null;
        
        previewContainer.addEventListener('dragstart', function(e) {
            draggedElement = e.target.closest('.image-preview-item');
            if (draggedElement) {
                draggedElement.classList.add('dragging');
            }
        });
        
        previewContainer.addEventListener('dragover', function(e) {
            e.preventDefault();
        });
        
        previewContainer.addEventListener('drop', function(e) {
            e.preventDefault();
            const targetElement = e.target.closest('.image-preview-item');
            
            if (draggedElement && targetElement && draggedElement !== targetElement) {
                const draggedIndex = parseInt(draggedElement.dataset.index);
                const targetIndex = parseInt(targetElement.dataset.index);
                
                // é…åˆ—å†…ã§è¦ç´ ã‚’å…¥ã‚Œæ›¿ãˆ
                const temp = uploadedImages[draggedIndex];
                uploadedImages[draggedIndex] = uploadedImages[targetIndex];
                uploadedImages[targetIndex] = temp;
                
                // è¡¨ç¤ºé †åºã‚’æ›´æ–°
                uploadedImages.forEach((image, idx) => {
                    image.displayOrder = idx + 1;
                });
                
                updateImagePreview();
            }
            
            if (draggedElement) {
                draggedElement.classList.remove('dragging');
                draggedElement = null;
            }
        });
        
        // ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ã«è¨­å®š
        const previewItems = previewContainer.querySelectorAll('.image-preview-item');
        previewItems.forEach(item => {
            item.draggable = true;
        });
    }
    
    // ä¸¦ã³é †å¤‰æ›´ãƒœã‚¿ãƒ³
    function reorderImages() {
        if (uploadedImages.length <= 1) {
            showInfo('ä¸¦ã³æ›¿ãˆã‚‹ç”»åƒãŒã‚ã‚Šã¾ã›ã‚“');
            return;
        }
        
        showInfo('ç”»åƒã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ä¸¦ã³é †ã‚’å¤‰æ›´ã§ãã¾ã™');
    }
    
    // æ—¢å­˜ç”»åƒèª­ã¿è¾¼ã¿ï¼ˆEditç”»é¢ç”¨ï¼‰
    function loadExistingImages() {
        // Editç”»é¢ã®å ´åˆã€æ—¢å­˜ç”»åƒæƒ…å ±ã‚’èª­ã¿è¾¼ã‚€
        // ã“ã®é–¢æ•°ã¯ã€ç·¨é›†ç”»é¢ã§å‘¼ã³å‡ºã•ã‚Œã‚‹æƒ³å®š
    }
    
    // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
    function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã®ç”»åƒãƒ‡ãƒ¼ã‚¿å‡¦ç†
    function getImageFormData() {
        const formData = new FormData();
        
        uploadedImages.forEach((image, index) => {
            formData.append(`ImageFiles`, image.file);
            formData.append(`ImageAltTexts[${index}]`, image.altText || '');
            formData.append(`ImageDisplayOrders[${index}]`, image.displayOrder);
            formData.append(`ImageIsMain[${index}]`, image.isMain);
        });
        
        return formData;
    }
    
    // åˆæœŸåŒ–ï¼ˆãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å‘¼ã³å‡ºã—ï¼‰
    document.addEventListener('DOMContentLoaded', function() {
        initializeImageUpload();
    });
</script>

<style>
    /* ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é–¢é€£ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .product-image-upload-container {
        margin-bottom: 2rem;
    }
    
    .upload-zone {
        border: 2px dashed #ccc;
        border-radius: 8px;
        padding: 2rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        background-color: #fafafa;
    }
    
    .upload-zone:hover {
        border-color: #007bff;
        background-color: #f0f8ff;
    }
    
    .upload-zone.drag-over {
        border-color: #007bff;
        background-color: #e3f2fd;
        transform: scale(1.02);
    }
    
    .upload-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
    }
    
    .upload-title {
        margin-bottom: 0.5rem;
        color: #333;
    }
    
    .upload-description {
        margin-bottom: 1rem;
        color: #666;
    }
    
    .upload-constraints {
        margin-top: 1rem;
        color: #888;
        font-size: 0.9rem;
    }
    
    .image-preview-area,
    .existing-images-area {
        margin-top: 2rem;
    }
    
    .image-preview-container,
    .existing-image-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
    }
    
    .image-preview-item {
        border: 1px solid #ddd;
        border-radius: 8px;
        overflow: hidden;
        background-color: white;
        transition: transform 0.2s ease;
        position: relative;
    }
    
    .image-preview-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .image-preview-item.main-image {
        border-color: #007bff;
        box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
    }
    
    .image-preview-item.dragging {
        opacity: 0.5;
        transform: rotate(5deg);
    }
    
    .preview-image-container {
        position: relative;
        height: 150px;
        overflow: hidden;
    }
    
    .preview-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .preview-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0,0,0,0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 0.5rem;
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .image-preview-item:hover .preview-overlay {
        opacity: 1;
    }
    
    .overlay-btn {
        background: white;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        cursor: pointer;
        font-size: 1.2rem;
        transition: transform 0.2s ease;
    }
    
    .overlay-btn:hover {
        transform: scale(1.1);
    }
    
    .main-badge {
        position: absolute;
        top: 0.5rem;
        left: 0.5rem;
        background-color: #007bff;
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: bold;
    }
    
    .preview-info {
        padding: 0.75rem;
    }
    
    .preview-name {
        font-weight: 500;
        margin-bottom: 0.25rem;
        word-break: break-all;
    }
    
    .preview-details {
        display: flex;
        justify-content: space-between;
        font-size: 0.875rem;
        color: #666;
    }
    
    .preview-actions {
        margin-top: 1rem;
        display: flex;
        gap: 0.5rem;
    }
    
    /* ãƒ¢ãƒ¼ãƒ€ãƒ«é–¢é€£ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .image-edit-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        align-items: start;
    }
    
    .image-edit-preview {
        text-align: center;
    }
    
    .edit-preview-img {
        max-width: 100%;
        max-height: 300px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .image-view-container {
        text-align: center;
    }
    
    .view-image {
        max-width: 100%;
        max-height: 80vh;
        border-radius: 8px;
    }
</style>