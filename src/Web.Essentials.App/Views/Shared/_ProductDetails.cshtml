@model Web.Essentials.App.ViewModels.ProductDetailsDisplayViewModel
@using Web.Essentials.Domain.Entities
<!-- ÂïÜÂìÅË©≥Á¥∞Ë°®Á§∫ÈÉ®ÂàÜ„Éì„É•„Éº -->
<!-- ÂïÜÂìÅÊÉÖÂ†±„ÅÆË™≠„ÅøÂèñ„ÇäÂ∞ÇÁî®Ë°®Á§∫ -->
<!-- Details/DeleteÁ¢∫Ë™çÁîªÈù¢„ÅßÂÖ±ÈÄöÂà©Áî® -->

@{
    var showActions = ViewBag.ShowActions as bool? ?? true;
    var isDeleteMode = ViewBag.IsDeleteMode as bool? ?? false;
    var showFullDetails = ViewBag.ShowFullDetails as bool? ?? true;
}

<div class="Model-details-display">
    <!-- ÂïÜÂìÅÊ¶ÇË¶Å„Ç´„Éº„Éâ -->
    <div class="Model-overview-card">
        <div class="Model-overview-content">
            <!-- ÂïÜÂìÅÁîªÂÉè„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="Model-images-section">
                @if (Model.Images?.Any() == true)
                {
                    <div class="Model-images-gallery">
                        @{
                            var mainImage = Model.Images.FirstOrDefault();
                            foreach (var img in Model.Images)
                            {
                                if (img.IsMain)
                                {
                                    mainImage = img;
                                    break;
                                }
                            }
                        }
                        <!-- „É°„Ç§„É≥ÁîªÂÉè -->
                        <div class="main-image-container">
                            <img src="@mainImage.ImagePath" 
                                 alt="@mainImage.AltText" 
                                 class="main-Model-image" 
                                 data-action="open-image-viewer" 
                                 data-image-path="@mainImage.ImagePath" 
                                 data-alt-text="@mainImage.AltText" />
                            <div class="image-overlay">
                                <span class="zoom-hint">„ÇØ„É™„ÉÉ„ÇØ„ÅßÊã°Â§ß</span>
                            </div>
                        </div>
                        
                        <!-- „Çµ„É†„Éç„Ç§„É´ÁîªÂÉè -->
                        @if (Model.Images.Count() > 1)
                        {
                            <div class="thumbnail-images">
                                @foreach (var image in Model.Images)
                                {
                                    <div class="thumbnail-item @(image.IsMain ? "main" : "")"
                                         data-action="switch-main-image" 
                                         data-image-path="@image.ImagePath" 
                                         data-alt-text="@image.AltText">
                                        <img src="@image.ImagePath" 
                                             alt="@image.AltText" 
                                             class="thumbnail-image" />
                                        @if (image.IsMain)
                                        {
                                            <div class="main-indicator">„É°„Ç§„É≥</div>
                                        }
                                    </div>
                                }
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="no-image-display">
                        <img src="/images/no-image.png" alt="ÁîªÂÉè„Å™„Åó" class="no-image-placeholder" />
                        <p class="no-image-text">ÁîªÂÉè„ÅåÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</p>
                    </div>
                }
            </div>
            
            <!-- ÂïÜÂìÅÂü∫Êú¨ÊÉÖÂ†±„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="Model-basic-section">
                <!-- ÂïÜÂìÅÂêç„Å®„Çπ„ÉÜ„Éº„Çø„Çπ -->
                <div class="Model-header-info">
                    <h2 class="Model-display-name">@Model.Name</h2>
                    <div class="Model-status-info">
                        @switch (Model.Status)
                        {
                            case ProductStatus.PreSale:
                                <span class="status-badge status-pending">Ë≤©Â£≤ÈñãÂßãÂâç</span>
                                break;
                            case ProductStatus.OnSale:
                                <span class="status-badge status-active">Ë≤©Â£≤‰∏≠</span>
                                break;
                            case ProductStatus.Discontinued:
                                <span class="status-badge status-discontinued">ÂèñÊâ±ÁµÇ‰∫Ü</span>
                                break;
                        }
                    </div>
                </div>
                
                <!-- ‰æ°Ê†ºË°®Á§∫ -->
                <div class="Model-price-info">
                    <div class="price-display">
                        <span class="price-currency">¬•</span>
                        <span class="price-amount">@Model.Price.ToString("N0")</span>
                        <span class="price-note">ÔºàÁ®éËæºÔºâ</span>
                    </div>
                </div>
                
                <!-- ÂïÜÂìÅË™¨Êòé -->
                @if (!string.IsNullOrEmpty(Model.Description))
                {
                    <div class="Model-description-section">
                        <h3 class="description-title">ÂïÜÂìÅË™¨Êòé</h3>
                        <div class="description-content">
                            @Html.Raw(Model.Description.Replace("\n", "<br />"))
                        </div>
                    </div>
                }
                
                <!-- „Ç´„ÉÜ„Ç¥„É™ÊÉÖÂ†± -->
                @if (Model.Categories?.Any() == true)
                {
                    <div class="Model-categories-section">
                        <h3 class="categories-title">„Ç´„ÉÜ„Ç¥„É™</h3>
                        <div class="categories-display">
                            @foreach (var category in Model.Categories)
                            {
                                <div class="category-tag">
                                    <span class="category-icon">üè∑Ô∏è</span>
                                    <span class="category-path">@category.FullPath</span>
                                    @if (showActions && !isDeleteMode)
                                    {
                                        <a asp-action="Details" asp-controller="Categories" asp-route-id="@category.Id" 
                                           class="category-link"
                                           title="„Ç´„ÉÜ„Ç¥„É™Ë©≥Á¥∞„ÇíË°®Á§∫">
                                            ‚Üí
                                        </a>
                                    }
                                </div>
                            }
                        </div>
                    </div>
                }
            </div>
        </div>
        
        <!-- „Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ÔºàË°®Á§∫„É¢„Éº„Éâ„Å´Âøú„Åò„Å¶Ôºâ -->
        @if (showActions && !isDeleteMode)
        {
            <div class="Model-actions-section">
                <div class="action-buttons">
                    <a asp-action="Edit" asp-controller="Products" asp-route-id="@Model.Id" 
                       class="btn btn-primary">
                        <span class="btn-icon">‚úèÔ∏è</span>
                        Á∑®ÈõÜ
                    </a>
                    <button type="button" 
                            class="btn btn-outline" 
                            data-action="share-Model" 
                            data-Model-id="@Model.Id" 
                            data-Model-name="@Model.Name">
                        <span class="btn-icon">üì§</span>
                        ÂÖ±Êúâ
                    </button>
                    <button type="button" 
                            class="btn btn-light" 
                            data-action="duplicate-Model" 
                            data-Model-id="@Model.Id">
                        <span class="btn-icon">üìã</span>
                        Ë§áË£Ω
                    </button>
                </div>
            </div>
        }
    </div>
    
    <!-- Ë©≥Á¥∞ÊÉÖÂ†±Ôºà„Éï„É´Ë°®Á§∫„É¢„Éº„Éâ„ÅÆÂ†¥ÂêàÔºâ -->
    @if (showFullDetails)
    {
        <div class="Model-detailed-info">
            <!-- ÂïÜÂìÅ‰ªïÊßòÊÉÖÂ†± -->
            <div class="specifications-section">
                <h3 class="section-title">ÂïÜÂìÅ‰ªïÊßò</h3>
                <div class="specifications-grid">
                    <div class="spec-row">
                        <div class="spec-label">ÂïÜÂìÅID</div>
                        <div class="spec-value">@Model.Id</div>
                    </div>
                    
                    @if (!string.IsNullOrEmpty(Model.JanCode))
                    {
                        <div class="spec-row">
                            <div class="spec-label">JAN„Ç≥„Éº„Éâ</div>
                            <div class="spec-value">
                                <code class="jan-code-display">@Model.JanCode</code>
                                @if (showActions)
                                {
                                    <button type="button" 
                                            class="copy-button" 
                                            data-action="copy-to-clipboard" 
                                            data-copy-text="@Model.JanCode"
                                            title="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº">
                                        üìã
                                    </button>
                                }
                            </div>
                        </div>
                    }
                    
                    <div class="spec-row">
                        <div class="spec-label">ÂïÜÂìÅ„Çπ„ÉÜ„Éº„Çø„Çπ</div>
                        <div class="spec-value">
                            @switch (Model.Status)
                            {
                                case ProductStatus.PreSale:
                                    <span class="status-text">Ë≤©Â£≤ÈñãÂßãÂâç</span>
                                    break;
                                case ProductStatus.OnSale:
                                    <span class="status-text">Ë≤©Â£≤‰∏≠</span>
                                    break;
                                case ProductStatus.Discontinued:
                                    <span class="status-text">ÂèñÊâ±ÁµÇ‰∫Ü</span>
                                    break;
                            }
                        </div>
                    </div>
                    
                    @if (Model.Images?.Any() == true)
                    {
                        <div class="spec-row">
                            <div class="spec-label">ÁôªÈå≤ÁîªÂÉèÊï∞</div>
                            <div class="spec-value">@Model.Images.Count() Êûö</div>
                        </div>
                    }
                    
                    @if (Model.Categories?.Any() == true)
                    {
                        <div class="spec-row">
                            <div class="spec-label">Èñ¢ÈÄ£„Ç´„ÉÜ„Ç¥„É™Êï∞</div>
                            <div class="spec-value">@Model.Categories.Count() ÂÄã</div>
                        </div>
                    }
                </div>
            </div>
            
            <!-- ÁÆ°ÁêÜÊÉÖÂ†± -->
            <div class="management-info-section">
                <h3 class="section-title">ÁÆ°ÁêÜÊÉÖÂ†±</h3>
                <div class="management-grid">
                    <div class="management-row">
                        <div class="management-label">‰ΩúÊàêÊó•ÊôÇ</div>
                        <div class="management-value">
                            <time datetime="@Model.CreatedAt.ToString("yyyy-MM-ddTHH:mm:ss")">
                                @Model.CreatedAt.ToString("yyyyÂπ¥MMÊúàddÊó• HH:mm:ss")
                            </time>
                        </div>
                    </div>
                    
                    <div class="management-row">
                        <div class="management-label">ÊúÄÁµÇÊõ¥Êñ∞Êó•ÊôÇ</div>
                        <div class="management-value">
                            <time datetime="@Model.UpdatedAt.ToString("yyyy-MM-ddTHH:mm:ss")">
                                @Model.UpdatedAt.ToString("yyyyÂπ¥MMÊúàddÊó• HH:mm:ss")
                            </time>
                        </div>
                    </div>
                    
                    @if (Model.CreatedAt != Model.UpdatedAt)
                    {
                        <div class="management-row">
                            <div class="management-label">ÊúÄÁµÇÊõ¥Êñ∞„Åã„Çâ„ÅÆÁµåÈÅéÊôÇÈñì</div>
                            <div class="management-value">
                                @{
                                    var timeDiff = DateTime.Now - Model.UpdatedAt;
                                    var timeDiffText = timeDiff.Days > 0 ? $"{timeDiff.Days}Êó•Ââç" :
                                                      timeDiff.Hours > 0 ? $"{timeDiff.Hours}ÊôÇÈñìÂâç" :
                                                      timeDiff.Minutes > 0 ? $"{timeDiff.Minutes}ÂàÜÂâç" : "1ÂàÜ‰ª•ÂÜÖ";
                                }
                                <span class="time-diff">@timeDiffText</span>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    }
</div>

<!-- ÁîªÂÉè„Éì„É•„Éº„Ç¢„Éº„É¢„Éº„ÉÄ„É´ -->
<div id="imageViewerModal" class="modal-overlay image-viewer-modal" style="display: none;">
    <div class="modal-dialog modal-large">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="imageViewerTitle">ÂïÜÂìÅÁîªÂÉè</h3>
                <button type="button" class="modal-close" data-action="close-image-viewer">
                    <span>√ó</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="image-viewer-container">
                    <img id="viewerImage" src="" alt="" class="viewer-image" />
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/Model-details.js" asp-append-version="true" defer></script>
}

@section Styles {
    <link rel="stylesheet" href="~/css/Model-details.css" asp-append-version="true" />
}