@model IEnumerable<Web.Essentials.App.ViewModels.CategorySelectItem>
<!-- éšå±¤ã‚«ãƒ†ã‚´ãƒªé¸æŠéƒ¨åˆ†ãƒ“ãƒ¥ãƒ¼ -->
<!-- éšå±¤æ§‹é€ å¯¾å¿œã®ã‚«ãƒ†ã‚´ãƒªé¸æŠUI -->
<!-- å•†å“Create/Editç”»é¢ã§å…±é€šåˆ©ç”¨ -->

@{
    var categories = Model ?? new List<Web.Essentials.App.ViewModels.CategorySelectItem>();
    var selectedCategoryId = ViewBag.SelectedCategoryId as int?;
    var fieldName = ViewBag.FieldName as string ?? "CategoryId";
    var isRequired = ViewBag.IsRequired as bool? ?? true;
    var allowMultiple = ViewBag.AllowMultiple as bool? ?? false;
    var showSearch = ViewBag.ShowSearch as bool? ?? true;
}

<div class="category-select-container">
    <div class="category-select-header">
        <label for="@fieldName" class="form-label @(isRequired ? "required" : "")">
            @(ViewBag.Label ?? "ã‚«ãƒ†ã‚´ãƒª")
        </label>
        @if (showSearch)
        {
            <div class="category-search">
                <input type="text" 
                       id="categorySearchInput" 
                       class="category-search-input" 
                       placeholder="ã‚«ãƒ†ã‚´ãƒªã‚’æ¤œç´¢..."
                       oninput="filterCategories(this.value)" />
                <span class="search-icon">ğŸ”</span>
            </div>
        }
    </div>
    
    <!-- ã‚«ãƒ†ã‚´ãƒªé¸æŠæ–¹å¼åˆ‡ã‚Šæ›¿ãˆ -->
    <div class="category-select-modes">
        <div class="mode-tabs">
            <button type="button" 
                    class="mode-tab active" 
                    data-mode="select" 
                    onclick="switchCategoryMode('select')">
                é¸æŠãƒªã‚¹ãƒˆ
            </button>
            <button type="button" 
                    class="mode-tab" 
                    data-mode="tree" 
                    onclick="switchCategoryMode('tree')">
                éšå±¤ãƒ„ãƒªãƒ¼
            </button>
            @if (allowMultiple)
            {
                <button type="button" 
                        class="mode-tab" 
                        data-mode="checkbox" 
                        onclick="switchCategoryMode('checkbox')">
                    è¤‡æ•°é¸æŠ
                </button>
            }
        </div>
    </div>
    
    <!-- é¸æŠãƒªã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ -->
    <div id="selectMode" class="category-mode select-mode active">
        <select name="@fieldName" 
                id="@fieldName" 
                class="form-select category-select"
                @(isRequired ? "required" : "")
                @(allowMultiple ? "multiple" : "")
                onchange="updateCategorySelection()">
            @if (!allowMultiple)
            {
                <option value="">ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ãã ã•ã„</option>
            }
            @foreach (var category in categories.OrderBy(c => c.Level).ThenBy(c => c.Name))
            {
                <option value="@category.Id" 
                        data-level="@category.Level"
                        data-full-path="@category.FullPath"
                        selected="@(selectedCategoryId == category.Id)">
                    @(new string('ã€€', category.Level * 2))@category.Name
                </option>
            }
        </select>
        <div class="selected-category-info" id="selectedCategoryInfo" style="display: none;">
            <div class="info-label">é¸æŠä¸­ã®ã‚«ãƒ†ã‚´ãƒª:</div>
            <div class="info-path" id="selectedCategoryPath"></div>
        </div>
    </div>
    
    <!-- éšå±¤ãƒ„ãƒªãƒ¼ãƒ¢ãƒ¼ãƒ‰ -->
    <div id="treeMode" class="category-mode tree-mode">
        <div class="category-tree-container">
            <div id="categoryTree" class="category-tree">
                @if (categories.Any())
                {
                    @Html.Partial("_CategoryHierarchy", categories.Where(c => c.Level == 0))
                }
                else
                {
                    <div class="no-categories">
                        <p>ã‚«ãƒ†ã‚´ãƒªãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
                    </div>
                }
            </div>
        </div>
        <!-- éš ã—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆãƒ„ãƒªãƒ¼ãƒ¢ãƒ¼ãƒ‰ç”¨ï¼‰ -->
        <input type="hidden" name="@fieldName" id="@(fieldName)_Tree" value="@selectedCategoryId" />
    </div>
    
    <!-- è¤‡æ•°é¸æŠãƒ¢ãƒ¼ãƒ‰ -->
    @if (allowMultiple)
    {
        <div id="checkboxMode" class="category-mode checkbox-mode">
            <div class="category-checkbox-container">
                @foreach (var category in categories.OrderBy(c => c.Level).ThenBy(c => c.Name))
                {
                    <div class="category-checkbox-item level-@category.Level" data-category-id="@category.Id">
                        <label class="checkbox-label">
                            <input type="checkbox" 
                                   name="@fieldName" 
                                   value="@category.Id" 
                                   class="checkbox-input category-checkbox"
                                   data-level="@category.Level"
                                   data-full-path="@category.FullPath"
                                   onchange="updateMultipleSelection()" />
                            <span class="checkbox-custom"></span>
                            <span class="category-name">
                                @(new string('ã€€', category.Level * 2))@category.Name
                            </span>
                            <span class="category-path">(@category.FullPath)</span>
                        </label>
                    </div>
                }
            </div>
            <div class="selected-categories-summary" id="selectedCategoriesSummary" style="display: none;">
                <div class="summary-label">é¸æŠä¸­ã®ã‚«ãƒ†ã‚´ãƒª:</div>
                <div class="summary-list" id="selectedCategoriesList"></div>
            </div>
        </div>
    }
    
    <!-- ã‚«ãƒ†ã‚´ãƒªéšå±¤æƒ…å ±è¡¨ç¤º -->
    <div class="category-hierarchy-info" id="categoryHierarchyInfo" style="display: none;">
        <div class="hierarchy-label">éšå±¤æƒ…å ±:</div>
        <div class="hierarchy-details">
            <div class="hierarchy-level">
                ãƒ¬ãƒ™ãƒ«: <span id="categoryLevel">-</span>
            </div>
            <div class="hierarchy-path">
                ãƒ‘ã‚¹: <span id="categoryFullPath">-</span>
            </div>
        </div>
    </div>
    
    <!-- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼è¡¨ç¤º -->
    <div id="categoryValidationError" class="validation-error" style="display: none;"></div>
    
    <!-- ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆ -->
    <div class="category-help">
        <small>
            @if (allowMultiple)
            {
                <span>è¤‡æ•°ã®ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã§ãã¾ã™ã€‚éšå±¤ã®æ·±ã„ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚</span>
            }
            else
            {
                <span>å•†å“ã«æœ€ã‚‚é©ã—ãŸã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚éšå±¤ã®æ·±ã„ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚</span>
            }
        </small>
    </div>
</div>

<script>
    // ã‚«ãƒ†ã‚´ãƒªé¸æŠé–¢é€£ã®å¤‰æ•°
    let categoryData = @Html.Raw(Json.Serialize(categories));
    let currentMode = 'select';
    let selectedCategories = [];
    
    // ã‚«ãƒ†ã‚´ãƒªé¸æŠã®åˆæœŸåŒ–
    function initializeCategorySelect() {
        setupCategoryModes();
        setupTreeInteraction();
        updateCategorySelection();
        
        // åˆæœŸé¸æŠå€¤ã®è¨­å®š
        @if (selectedCategoryId.HasValue)
        {
            <text>
            setInitialSelection(@selectedCategoryId.Value);
            </text>
        }
    }
    
    // ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
    function switchCategoryMode(mode) {
        // ã‚¿ãƒ–ã®çŠ¶æ…‹æ›´æ–°
        document.querySelectorAll('.mode-tab').forEach(tab => {
            tab.classList.remove('active');
        });
        document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
        
        // ãƒ¢ãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
        document.querySelectorAll('.category-mode').forEach(modeDiv => {
            modeDiv.classList.remove('active');
        });
        document.getElementById(mode + 'Mode').classList.add('active');
        
        currentMode = mode;
        updateCategorySelection();
    }
    
    // ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    function filterCategories(searchTerm) {
        const term = searchTerm.toLowerCase();
        
        if (currentMode === 'select') {
            // é¸æŠãƒªã‚¹ãƒˆã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            const select = document.getElementById('@fieldName');
            const options = select.querySelectorAll('option');
            
            options.forEach(option => {
                if (option.value === '') return; // ç©ºã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã‚¹ã‚­ãƒƒãƒ—
                
                const categoryName = option.textContent.toLowerCase();
                const fullPath = option.dataset.fullPath?.toLowerCase() || '';
                
                if (categoryName.includes(term) || fullPath.includes(term)) {
                    option.style.display = '';
                } else {
                    option.style.display = 'none';
                }
            });
        } else if (currentMode === 'checkbox') {
            // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒªã‚¹ãƒˆã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            const checkboxItems = document.querySelectorAll('.category-checkbox-item');
            
            checkboxItems.forEach(item => {
                const categoryName = item.querySelector('.category-name').textContent.toLowerCase();
                const fullPath = item.querySelector('.category-path').textContent.toLowerCase();
                
                if (categoryName.includes(term) || fullPath.includes(term)) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
        } else if (currentMode === 'tree') {
            // ãƒ„ãƒªãƒ¼ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            filterTreeNodes(term);
        }
    }
    
    // ãƒ„ãƒªãƒ¼ãƒãƒ¼ãƒ‰ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
    function filterTreeNodes(searchTerm) {
        const treeItems = document.querySelectorAll('.tree-item');
        
        treeItems.forEach(item => {
            const categoryName = item.querySelector('.tree-label').textContent.toLowerCase();
            
            if (categoryName.includes(searchTerm)) {
                item.style.display = '';
                // è¦ªãƒãƒ¼ãƒ‰ã‚‚è¡¨ç¤º
                showParentNodes(item);
            } else {
                item.style.display = 'none';
            }
        });
    }
    
    // è¦ªãƒãƒ¼ãƒ‰è¡¨ç¤º
    function showParentNodes(element) {
        let parent = element.parentElement;
        while (parent && parent.classList.contains('tree-children')) {
            parent.style.display = '';
            parent = parent.parentElement.parentElement; // tree-item > tree-children
        }
    }
    
    // ã‚«ãƒ†ã‚´ãƒªé¸æŠæ›´æ–°
    function updateCategorySelection() {
        const selectedId = getCurrentSelectedId();
        
        if (selectedId) {
            const category = categoryData.find(c => c.Id == selectedId);
            if (category) {
                updateCategoryInfo(category);
            }
        } else {
            hideCategoryInfo();
        }
        
        // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        validateCategorySelection();
    }
    
    // ç¾åœ¨é¸æŠä¸­ã®IDå–å¾—
    function getCurrentSelectedId() {
        if (currentMode === 'select') {
            return document.getElementById('@fieldName').value;
        } else if (currentMode === 'tree') {
            return document.getElementById('@(fieldName)_Tree').value;
        }
        return null;
    }
    
    // è¤‡æ•°é¸æŠæ›´æ–°
    function updateMultipleSelection() {
        const checkedBoxes = document.querySelectorAll('.category-checkbox:checked');
        selectedCategories = Array.from(checkedBoxes).map(cb => {
            return {
                id: cb.value,
                name: cb.parentElement.querySelector('.category-name').textContent.trim(),
                fullPath: cb.dataset.fullPath
            };
        });
        
        updateMultipleSelectionDisplay();
        validateCategorySelection();
    }
    
    // è¤‡æ•°é¸æŠè¡¨ç¤ºæ›´æ–°
    function updateMultipleSelectionDisplay() {
        const summary = document.getElementById('selectedCategoriesSummary');
        const list = document.getElementById('selectedCategoriesList');
        
        if (selectedCategories.length > 0) {
            summary.style.display = 'block';
            list.innerHTML = selectedCategories.map(cat => `
                <div class="selected-category-tag">
                    <span class="tag-name">${cat.name}</span>
                    <span class="tag-path">(${cat.fullPath})</span>
                    <button type="button" class="tag-remove" onclick="removeSelectedCategory('${cat.id}')">Ã—</button>
                </div>
            `).join('');
        } else {
            summary.style.display = 'none';
        }
    }
    
    // é¸æŠã‚«ãƒ†ã‚´ãƒªå‰Šé™¤
    function removeSelectedCategory(categoryId) {
        const checkbox = document.querySelector(`.category-checkbox[value="${categoryId}"]`);
        if (checkbox) {
            checkbox.checked = false;
            updateMultipleSelection();
        }
    }
    
    // ã‚«ãƒ†ã‚´ãƒªæƒ…å ±æ›´æ–°
    function updateCategoryInfo(category) {
        const info = document.getElementById('selectedCategoryInfo');
        const hierarchyInfo = document.getElementById('categoryHierarchyInfo');
        
        if (currentMode === 'select') {
            document.getElementById('selectedCategoryPath').textContent = category.FullPath;
            info.style.display = 'block';
        }
        
        // éšå±¤æƒ…å ±æ›´æ–°
        document.getElementById('categoryLevel').textContent = category.Level;
        document.getElementById('categoryFullPath').textContent = category.FullPath;
        hierarchyInfo.style.display = 'block';
    }
    
    // ã‚«ãƒ†ã‚´ãƒªæƒ…å ±éè¡¨ç¤º
    function hideCategoryInfo() {
        document.getElementById('selectedCategoryInfo').style.display = 'none';
        document.getElementById('categoryHierarchyInfo').style.display = 'none';
    }
    
    // ãƒ„ãƒªãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³è¨­å®š
    function setupTreeInteraction() {
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('tree-toggle')) {
                toggleTreeNode(e.target);
            } else if (e.target.classList.contains('tree-label')) {
                selectTreeNode(e.target);
            }
        });
    }
    
    // ãƒ„ãƒªãƒ¼ãƒãƒ¼ãƒ‰é–‹é–‰
    function toggleTreeNode(toggleElement) {
        const treeItem = toggleElement.closest('.tree-item');
        const children = treeItem.querySelector('.tree-children');
        
        if (children) {
            const isExpanded = toggleElement.textContent === 'â–¼';
            toggleElement.textContent = isExpanded ? 'â–¶' : 'â–¼';
            children.style.display = isExpanded ? 'none' : 'block';
            treeItem.classList.toggle('expanded', !isExpanded);
        }
    }
    
    // ãƒ„ãƒªãƒ¼ãƒãƒ¼ãƒ‰é¸æŠ
    function selectTreeNode(labelElement) {
        const treeItem = labelElement.closest('.tree-item');
        const categoryId = treeItem.dataset.categoryId;
        
        // ä»–ã®é¸æŠã‚’è§£é™¤
        document.querySelectorAll('.tree-item.selected').forEach(item => {
            item.classList.remove('selected');
        });
        
        // æ–°ã—ã„é¸æŠã‚’è¨­å®š
        treeItem.classList.add('selected');
        document.getElementById('@(fieldName)_Tree').value = categoryId;
        
        updateCategorySelection();
    }
    
    // åˆæœŸé¸æŠè¨­å®š
    function setInitialSelection(categoryId) {
        if (currentMode === 'select') {
            document.getElementById('@fieldName').value = categoryId;
        } else if (currentMode === 'tree') {
            document.getElementById('@(fieldName)_Tree').value = categoryId;
            const treeItem = document.querySelector(`[data-category-id="${categoryId}"]`);
            if (treeItem) {
                treeItem.classList.add('selected');
            }
        } else if (currentMode === 'checkbox') {
            const checkbox = document.querySelector(`.category-checkbox[value="${categoryId}"]`);
            if (checkbox) {
                checkbox.checked = true;
                updateMultipleSelection();
            }
        }
    }
    
    // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    function validateCategorySelection() {
        const errorDiv = document.getElementById('categoryValidationError');
        let isValid = true;
        let errorMessage = '';
        
        @if (isRequired)
        {
            <text>
            if (currentMode === 'checkbox') {
                if (selectedCategories.length === 0) {
                    isValid = false;
                    errorMessage = 'ã‚«ãƒ†ã‚´ãƒªã‚’å°‘ãªãã¨ã‚‚1ã¤é¸æŠã—ã¦ãã ã•ã„';
                }
            } else {
                const selectedId = getCurrentSelectedId();
                if (!selectedId) {
                    isValid = false;
                    errorMessage = 'ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ãã ã•ã„';
                }
            }
            </text>
        }
        
        if (isValid) {
            errorDiv.style.display = 'none';
        } else {
            errorDiv.textContent = errorMessage;
            errorDiv.style.display = 'block';
        }
        
        return isValid;
    }
    
    // åˆæœŸåŒ–ï¼ˆãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å‘¼ã³å‡ºã—ï¼‰
    document.addEventListener('DOMContentLoaded', function() {
        initializeCategorySelect();
    });
</script>

<style>
    /* ã‚«ãƒ†ã‚´ãƒªé¸æŠé–¢é€£ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .category-select-container {
        margin-bottom: 1.5rem;
    }
    
    .category-select-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }
    
    .category-search {
        position: relative;
        max-width: 300px;
    }
    
    .category-search-input {
        padding: 0.5rem 2rem 0.5rem 0.75rem;
        border: 1px solid #ddd;
        border-radius: 4px;
        width: 100%;
    }
    
    .search-icon {
        position: absolute;
        right: 0.75rem;
        top: 50%;
        transform: translateY(-50%);
        color: #666;
    }
    
    .category-select-modes {
        margin-bottom: 1rem;
    }
    
    .mode-tabs {
        display: flex;
        border-bottom: 1px solid #ddd;
    }
    
    .mode-tab {
        padding: 0.75rem 1rem;
        border: none;
        background: none;
        cursor: pointer;
        border-bottom: 2px solid transparent;
        transition: all 0.3s ease;
    }
    
    .mode-tab.active {
        border-bottom-color: #007bff;
        color: #007bff;
        font-weight: 500;
    }
    
    .category-mode {
        display: none;
        padding: 1rem 0;
    }
    
    .category-mode.active {
        display: block;
    }
    
    .category-select {
        min-height: 2.5rem;
    }
    
    .selected-category-info {
        margin-top: 0.75rem;
        padding: 0.75rem;
        background-color: #f8f9fa;
        border-radius: 4px;
        border-left: 3px solid #007bff;
    }
    
    .info-label {
        font-weight: 500;
        margin-bottom: 0.25rem;
    }
    
    .info-path {
        color: #666;
        font-size: 0.9rem;
    }
    
    .category-tree-container {
        max-height: 400px;
        overflow-y: auto;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 1rem;
    }
    
    .category-checkbox-container {
        max-height: 300px;
        overflow-y: auto;
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 1rem;
    }
    
    .category-checkbox-item {
        margin-bottom: 0.5rem;
        padding-left: calc(var(--level, 0) * 1.5rem);
    }
    
    .category-checkbox-item.level-0 { --level: 0; }
    .category-checkbox-item.level-1 { --level: 1; }
    .category-checkbox-item.level-2 { --level: 2; }
    .category-checkbox-item.level-3 { --level: 3; }
    
    .category-name {
        font-weight: 500;
    }
    
    .category-path {
        color: #666;
        font-size: 0.85rem;
        margin-left: 0.5rem;
    }
    
    .selected-categories-summary {
        margin-top: 1rem;
        padding: 1rem;
        background-color: #f8f9fa;
        border-radius: 4px;
        border-left: 3px solid #28a745;
    }
    
    .summary-label {
        font-weight: 500;
        margin-bottom: 0.75rem;
    }
    
    .summary-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
    }
    
    .selected-category-tag {
        display: inline-flex;
        align-items: center;
        background-color: #007bff;
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 16px;
        font-size: 0.85rem;
    }
    
    .tag-name {
        font-weight: 500;
    }
    
    .tag-path {
        margin-left: 0.25rem;
        opacity: 0.8;
    }
    
    .tag-remove {
        background: none;
        border: none;
        color: white;
        margin-left: 0.5rem;
        cursor: pointer;
        font-weight: bold;
        padding: 0;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .tag-remove:hover {
        background-color: rgba(255,255,255,0.2);
    }
    
    .category-hierarchy-info {
        margin-top: 1rem;
        padding: 0.75rem;
        background-color: #e9ecef;
        border-radius: 4px;
    }
    
    .hierarchy-label {
        font-weight: 500;
        margin-bottom: 0.5rem;
    }
    
    .hierarchy-details {
        display: grid;
        grid-template-columns: 1fr 2fr;
        gap: 0.5rem;
        font-size: 0.9rem;
    }
    
    .category-help {
        margin-top: 0.75rem;
        color: #666;
    }
    
    .no-categories {
        text-align: center;
        padding: 2rem;
        color: #666;
    }
    
    /* ãƒ„ãƒªãƒ¼é–¢é€£ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .tree-item {
        margin: 0.25rem 0;
    }
    
    .tree-item.selected > .tree-label {
        background-color: #007bff;
        color: white;
    }
    
    .tree-toggle {
        cursor: pointer;
        margin-right: 0.5rem;
        user-select: none;
    }
    
    .tree-label {
        cursor: pointer;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        transition: background-color 0.2s ease;
    }
    
    .tree-label:hover {
        background-color: #f8f9fa;
    }
    
    .tree-children {
        margin-left: 1.5rem;
        border-left: 1px solid #ddd;
        padding-left: 0.5rem;
    }
</style>